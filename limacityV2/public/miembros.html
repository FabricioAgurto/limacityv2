<!doctype html><html lang="es"><head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Miembros â€” LimaCity RP</title><link rel="stylesheet" href="/assets/styles.css"></head><body>
<header><div class="nav container">
  <div class="brand"><span class="dot"></span><span>LimaCity RP</span></div>
  <div class="actions">
    <a class="btn" href="/normativas.html">Ver normativas</a>
    <a class="btn" href="/tienda.html">Tienda</a>
    <a class="btn" href="/miembros.html">Miembros</a>
    <a class="btn" href="https://discord.gg/" target="_blank" rel="noopener">Discord</a>
    <span id="badge-admin" class="badge" style="display:none;">ðŸ‘‘ Admin</span>
    <a id="btn-admin" class="btn" href="/dashboard.html" style="display:none">Panel admin</a>
    <a id="btn-login" class="btn btn-primary" href="/login.html" style="display:none">Iniciar sesiÃ³n</a>
</div>
</div></header>
<section class="hero"><div class="container">
  <div class="kicker">Staff & Comunidad</div>
  <h1>Miembros</h1>
  <p>Conoce al equipo y roles del servidor.</p>
</div></section>
<main class="container"><div id="list" class="grid"></div></main>
<footer class="footer">Â© LimaCity RP</footer>
<script>
(async ()=>{
  const token = localStorage.getItem('access_token') || '';
  const meRes = await fetch('/api/auth/me', { headers: token ? { 'Authorization':'Bearer '+token } : {} });
  const { user } = await meRes.json();
  const btnAdmin = document.getElementById('btn-admin');
  const btnLogin = document.getElementById('btn-login');
  const badge = document.getElementById('badge-admin');
  if (user) { btnLogin.style.display='none'; if((user.roles||[]).includes('admin')) badge.style.display='inline-flex'; if((user.roles||[]).some(r=>r==='admin'||r==='editor')) btnAdmin.style.display='inline-flex'; }
  else { btnLogin.style.display='inline-flex'; }

  const r = await fetch('/api/members/list');
  const { items } = await r.json();
  const root = document.getElementById('list'); root.innerHTML='';
  for(const m of (items||[])){
    const el=document.createElement('div'); el.className='card';
    el.innerHTML = `<div class="kicker">${m.role||'miembro'}</div><h3>${m.display_name||m.email}</h3><p class="muted">Desde ${new Date(m.created_at).toLocaleDateString()}</p>`;
    root.appendChild(el);
  }
})();
</script>
</body></html>